# æœåŠ¡ç®¡ç†è„šæœ¬è¯´æ˜

## ğŸ“‹ è„šæœ¬åˆ—è¡¨

### 1. `restart-services.sh` - æœåŠ¡å¯åŠ¨/é‡å¯è„šæœ¬

ç”¨äºæ‰‹åŠ¨å¯åŠ¨ã€é‡å¯ã€åœæ­¢æˆ–æŸ¥çœ‹å‰åç«¯æœåŠ¡çŠ¶æ€ã€‚

#### ä½¿ç”¨æ–¹æ³•

```bash
# é‡å¯æ‰€æœ‰æœåŠ¡ï¼ˆé»˜è®¤ï¼‰
./restart-services.sh

# æˆ–æŒ‡å®šå‘½ä»¤
./restart-services.sh [start|restart|stop|status]
```

#### å‘½ä»¤è¯´æ˜

- `start` - å¯åŠ¨æ‰€æœ‰æœåŠ¡ï¼ˆå‰ç«¯ + åç«¯ï¼‰
- `restart` - é‡å¯æ‰€æœ‰æœåŠ¡ï¼ˆé»˜è®¤å‘½ä»¤ï¼‰
- `stop` - åœæ­¢æ‰€æœ‰æœåŠ¡
- `status` - æŸ¥çœ‹æœåŠ¡è¿è¡ŒçŠ¶æ€

#### åŠŸèƒ½ç‰¹æ€§

- âœ… è‡ªåŠ¨æ£€æŸ¥å¹¶å®‰è£…ç¼ºå¤±çš„ä¾èµ–
- âœ… ä¼˜é›…åœ°åœæ­¢ç°æœ‰æœåŠ¡
- âœ… æ˜¾ç¤ºæœåŠ¡çŠ¶æ€å’Œæ—¥å¿—æ–‡ä»¶ä½ç½®
- âœ… å½©è‰²è¾“å‡ºï¼Œæ˜“äºé˜…è¯»
- âœ… è‡ªåŠ¨åˆ›å»ºæ—¥å¿—ç›®å½•

#### ç¤ºä¾‹

```bash
# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
./restart-services.sh status

# å¯åŠ¨æ‰€æœ‰æœåŠ¡
./restart-services.sh start

# åœæ­¢æ‰€æœ‰æœåŠ¡
./restart-services.sh stop

# é‡å¯æ‰€æœ‰æœåŠ¡
./restart-services.sh restart
```

---

### 2. `auto-restart-backend.py` - è‡ªåŠ¨ç›‘æ§é‡å¯è„šæœ¬

è‡ªåŠ¨ç›‘æ§åç«¯ä»£ç å˜åŒ–ï¼Œå½“æ£€æµ‹åˆ° `.py` æ–‡ä»¶ä¿®æ”¹æ—¶ï¼Œè‡ªåŠ¨é‡å¯åç«¯æœåŠ¡ã€‚

#### ä½¿ç”¨æ–¹æ³•

```bash
# å¯åŠ¨è‡ªåŠ¨ç›‘æ§
python3 auto-restart-backend.py
```

#### åŠŸèƒ½ç‰¹æ€§

- âœ… è‡ªåŠ¨ç›‘æ§ `backend/app` ç›®å½•ä¸‹çš„æ‰€æœ‰ Python æ–‡ä»¶
- âœ… æ£€æµ‹åˆ°æ–‡ä»¶å˜åŒ–æ—¶è‡ªåŠ¨é‡å¯åç«¯æœåŠ¡
- âœ… é˜²æŠ–å¤„ç†ï¼Œé¿å…é¢‘ç¹é‡å¯
- âœ… å¿½ç•¥ä¸éœ€è¦çš„æ–‡ä»¶ï¼ˆå¦‚ `__pycache__`ã€`.pyc` ç­‰ï¼‰

#### ç›‘æ§èŒƒå›´

- `backend/app/` ç›®å½•ä¸‹çš„æ‰€æœ‰ `.py` æ–‡ä»¶
- `backend/alembic/` ç›®å½•ä¸‹çš„æ–‡ä»¶
- `backend/requirements.txt`ã€`.env`ã€`alembic.ini` ç­‰é…ç½®æ–‡ä»¶

#### ä¾èµ–å®‰è£…

```bash
pip3 install watchdog
```

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### æ–¹å¼ä¸€ï¼šæ‰‹åŠ¨ç®¡ç†ï¼ˆæ¨èç”¨äºç”Ÿäº§ç¯å¢ƒï¼‰

```bash
# å¯åŠ¨æ‰€æœ‰æœåŠ¡
./restart-services.sh start

# æŸ¥çœ‹çŠ¶æ€
./restart-services.sh status

# åœæ­¢æ‰€æœ‰æœåŠ¡
./restart-services.sh stop
```

### æ–¹å¼äºŒï¼šè‡ªåŠ¨ç›‘æ§ï¼ˆæ¨èç”¨äºå¼€å‘ç¯å¢ƒï¼‰

```bash
# ç»ˆç«¯1: å¯åŠ¨è‡ªåŠ¨ç›‘æ§ï¼ˆç›‘æ§åç«¯ä»£ç å˜åŒ–ï¼‰
python3 auto-restart-backend.py

# ç»ˆç«¯2: å¯åŠ¨å‰ç«¯æœåŠ¡ï¼ˆå‰ç«¯é€šå¸¸ä¸éœ€è¦é¢‘ç¹é‡å¯ï¼‰
cd frontend && npm run dev
```

### æ–¹å¼ä¸‰ï¼šä¸€é”®å¯åŠ¨ï¼ˆæœ€ç®€å•ï¼‰

```bash
# é‡å¯æ‰€æœ‰æœåŠ¡
./restart-services.sh
```

---

## ğŸ“ æ—¥å¿—æ–‡ä»¶

æ‰€æœ‰æœåŠ¡çš„æ—¥å¿—æ–‡ä»¶ä¿å­˜åœ¨ `logs/` ç›®å½•ä¸‹ï¼š

- `logs/backend.log` - åç«¯æœåŠ¡æ—¥å¿—
- `logs/frontend.log` - å‰ç«¯æœåŠ¡æ—¥å¿—

---

## ğŸ”§ é…ç½®è¯´æ˜

### ç«¯å£é…ç½®

å¦‚æœéœ€è¦ä¿®æ”¹ç«¯å£ï¼Œè¯·ç¼–è¾‘ `restart-services.sh` æ–‡ä»¶ï¼š

```bash
BACKEND_PORT=8000   # åç«¯ç«¯å£
FRONTEND_PORT=3000  # å‰ç«¯ç«¯å£
```

### ç›‘æ§é…ç½®

å¦‚æœéœ€è¦ä¿®æ”¹ç›‘æ§èŒƒå›´ï¼Œè¯·ç¼–è¾‘ `auto-restart-backend.py` æ–‡ä»¶ï¼š

```python
# ç›‘æ§çš„æ–‡ä»¶æ‰©å±•å
WATCH_EXTENSIONS = {'.py', '.yaml', '.yml', '.env', '.txt'}

# ç›‘æ§çš„ç›®å½•
WATCH_DIRS = [
    'app',
    'alembic',
]
```

---

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **é¦–æ¬¡è¿è¡Œ**ï¼šè„šæœ¬ä¼šè‡ªåŠ¨æ£€æŸ¥å¹¶å®‰è£…ç¼ºå¤±çš„ä¾èµ–
2. **ç«¯å£å ç”¨**ï¼šå¦‚æœç«¯å£è¢«å ç”¨ï¼Œè„šæœ¬ä¼šè‡ªåŠ¨åœæ­¢å ç”¨è¯¥ç«¯å£çš„è¿›ç¨‹
3. **æ—¥å¿—æ–‡ä»¶**ï¼šæ—¥å¿—æ–‡ä»¶ä¼šè‡ªåŠ¨åˆ›å»ºåœ¨ `logs/` ç›®å½•ä¸‹
4. **æƒé™é—®é¢˜**ï¼šç¡®ä¿è„šæœ¬æœ‰æ‰§è¡Œæƒé™ï¼ˆ`chmod +x restart-services.sh`ï¼‰

---

## ğŸ› æ•…éšœæ’é™¤

### é—®é¢˜ï¼šæœåŠ¡å¯åŠ¨å¤±è´¥

1. æ£€æŸ¥ç«¯å£æ˜¯å¦è¢«å ç”¨ï¼š
   ```bash
   lsof -i:8000  # åç«¯
   lsof -i:3000  # å‰ç«¯
   ```

2. æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶ï¼š
   ```bash
   tail -f logs/backend.log
   tail -f logs/frontend.log
   ```

3. æ‰‹åŠ¨å¯åŠ¨æœåŠ¡æ£€æŸ¥é”™è¯¯ï¼š
   ```bash
   cd backend && python3 -m uvicorn app.main:app --reload
   cd frontend && npm run dev
   ```

### é—®é¢˜ï¼šè‡ªåŠ¨é‡å¯ä¸å·¥ä½œ

1. æ£€æŸ¥æ˜¯å¦å®‰è£…äº† `watchdog`ï¼š
   ```bash
   pip3 install watchdog
   ```

2. æ£€æŸ¥æ–‡ä»¶æƒé™ï¼š
   ```bash
   chmod +x auto-restart-backend.py
   ```

---

## ğŸ“ æ”¯æŒ

å¦‚æœ‰é—®é¢˜ï¼Œè¯·æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶æˆ–è”ç³»å¼€å‘å›¢é˜Ÿã€‚

